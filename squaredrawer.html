<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
</head>
<body>
Width:<input id="width" type="number" min="0" step="0.02" value="3.9" max="50">
Height:<input id="height" type="number" min="0" step="0.02" value="3.9" max="50">
Square:<input id="square" type="checkbox">
<button onclick="apply()">Apply</button>
<p>Or drag the lower right corner around</p>
<button onclick="rand()">Random</button>
<div id="svgContainer" style="resize:both;overflow:auto;"></div>
<p id="efficiency"></p>
<p id="comment" style="display:none"></p>
<canvas id="triangle"></canvas>
<script>
let widthInput = document.getElementById("width");
let heightInput = document.getElementById("height");
let squareInput = document.getElementById("square");
let svgContainer = document.getElementById("svgContainer");
let efficiency = document.getElementById("efficiency");
let comment = document.getElementById("comment");
function removeChildren(node){
	if(node){
		while(node.childElementCount){
			node.lastChild.remove()
		}
	}
}
function generateLattice(x,y,width,height){
	let coords = [];
	for(let i=0;i<Math.floor(width);i++){
		for(let j=0;j<Math.floor(height);j++){
			coords.push([x+i,y+j,0])
		}
	}
	return coords;
}

const s1 = Math.SQRT2;
const s2 = Math.SQRT2/2;
let c = Math.cos(Math.PI*49.818/180);
let s = Math.sin(Math.PI*49.818/180);
let t = Math.tan(Math.PI*49.818/180);

let squareList = [
	//{x: 1, y:1, n:1, coords:[[0,0,0]]},
	//{x: 2+s2, y:2+s2, n:5, coords:[[0,0,0],[1+s2,0,0],[0,1+s2,0],[1+s2,1+s2,0],[1-s2/2,1+s2/2,-45]]},
	{x: 3 + 2/Math.sqrt(5), y:3+1/Math.sqrt(5), n:10, coords:[
		[0,0,0],[1,0,0],[0,1,0],
		[2 + 2/Math.sqrt(5),0,0],
		[0,2+1/Math.sqrt(5),0],
		[2 + 2/Math.sqrt(5),2+1/Math.sqrt(5),0],[1 + 2/Math.sqrt(5),2+1/Math.sqrt(5),0],[2 + 2/Math.sqrt(5),1+1/Math.sqrt(5),0],
		[0.8 + 0.035,2.4 -0.035*2,-63.43494882292201],
		[1.8 - 0.08,1.4 +0.08*2,-63.43494882292201],
	]},
	{x: 7 / 2 + 3 * s2, y: 5 / 2 + 3 * s2, n:21, coords:[
		[0,0,0],
		[1,0,0],
		[0,1,0],

		[7 / 2 + 3 * s2 - 1,0,0],
		[7 / 2 + 3 * s2 - 2,0,0],
		[7 / 2 + 3 * s2 - 1,1,0],

		[7 / 2 + 3 * s2 - 1,5 / 2 + 3 * s2 - 1,0],
		[7 / 2 + 3 * s2 - 2,5 / 2 + 3 * s2 - 1,0],
		[7 / 2 + 3 * s2 - 1,5 / 2 + 3 * s2 - 2,0],

		[0,5 / 2 + 3 * s2 - 1,0],
		[1,5 / 2 + 3 * s2 - 1,0],
		[0,5 / 2 + 3 * s2 - 2,0],

		[1 - (-3 / 4 + 3 * s2/2),2+(-3 / 4 + 3 * s2/2),-45],
		[1 - (-3 / 4 + 3 * s2/2)+s2,2+(-3 / 4 + 3 * s2/2)-s2,-45],
		[1 - (-3 / 4 + 3 * s2/2)+s2*2,2+(-3 / 4 + 3 * s2/2)-s2*2,-45],

		[1 - (-3 / 4 + 3 * s2/2)+s2,2+(-3 / 4 + 3 * s2/2)+s2,-45],
		[1 - (-3 / 4 + 3 * s2/2)+s2+s2,2+(-3 / 4 + 3 * s2/2)-s2+s2,-45],
		[1 - (-3 / 4 + 3 * s2/2)+s2*2+s2,2+(-3 / 4 + 3 * s2/2)-s2*2+s2,-45],

		[1 - (-3 / 4 + 3 * s2/2)+s2*2,2+(-3 / 4 + 3 * s2/2)+s2*2,-45],
		[1 - (-3 / 4 + 3 * s2/2)+s2+s2*2,2+(-3 / 4 + 3 * s2/2)-s2+s2*2,-45],
		[1 - (-3 / 4 + 3 * s2/2)+s2*2+s2*2,2+(-3 / 4 + 3 * s2/2)-s2*2+s2*2,-45],
	]},
	{x: 3.87708359002281417730789706010, y:3.87708359002281417730789706010, n:11, coords:[
		[0,0,0],
		[0,3.87708359002281417730789706010-2,0],
		[0,3.87708359002281417730789706010-1,0],
		[3.87708359002281417730789706010-1,0,0],
		[1,3.87708359002281417730789706010-1,0],
		[2.03255694012844604 ,3.877084-1,0],//done
		[0.5676453633988737,1.511948770624432,-49.818062709670286],//done
		[t*(2*s - 1.511948770624432 )  + c +0.5676453633988737 ,s,-49.818062709670286],//done
		[0.5676453633988737 + s - c*0.118781,1.511948770624432 + c + s*0.118781,-49.818062709670286],//done
		[t*(2*s - 1.511948770624432 ) + c +0.5676453633988737 + s - c*0.118781,s + c + s*0.118781,-49.818062709670286],//done
		//[1.92,1.5,-49.818],
		[3.87708359002281417730789706010-s-c,2.401,-49.818062709670286],
	]},
	{x: 12*(1+s1)/5, y:6*(1+s1)/5, n:12, coords:[
		[0,6*(1+s1)/5-1,0],
		[0,6*(1+s1)/5-2,0],
		[1,6*(1+s1)/5-1,0],
		[12*(1+s1)/5-1,0,0],
		[12*(1+s1)/5-2,0,0],
		[12*(1+s1)/5-1,1,0],
		[3-6*(1+s1)/5 + s1,0,45],
		[3-6*(1+s1)/5 + s1*2,0,45],
		[3-6*(1+s1)/5 + s1+s2,s2,45],
		[12*(1+s1)/5-(3-6*(1+s1)/5 + s1),6*(1+s1)/5,-135],
		[12*(1+s1)/5-(3-6*(1+s1)/5 + s1*2),6*(1+s1)/5,-135],
		[12*(1+s1)/5-(3-6*(1+s1)/5 + s1+s2),6*(1+s1)/5-s2,-135],
	]},
	{x: 4.67553009360455095163411127048315, y:4.67553009360455095163411127048315, n:17, coords:[
		[0,0,0],//done
		[1,0,0],//done
		[0,1,0],//done
		[2.67553009360455095163411127048315,0,0],//done
		[3.67553009360455095163411127048315,0,0],//done
		[3.67553009360455095163411127048315,1,0],//done

		[3.67553009360455095163411127048315,2.11346013251256404552110105703833,0],

		[0,3.67553009360455095163411127048315,0],//done

		[1.84732482651028509718122846547049,3.67553009360455095163411127048315,0],

		[3.67553009360455095163411127048315,3.67553009360455095163411127048315,0],//done

		[2.23126048295327188587059610137880,0.72248139200922175219168287171559,39.8049589774499973462400047793339],
		[2.22455253828333495549006470982323,2.09257499378867968722973417022601,39.8049589774499973462400047793339],
		[1.49271119994262770175560192341917,1.40873371618283432601585800379015,39.8049589774499973462400047793339],
		[2.96310182129397913960505888778287,1.40632266961506711340555903815146,39.8049589774499973462400047793339],

		[0.64017619242926608758416854327031,2,39.8049589774499973462400047793339],
		[1.382,2.678,39.8049589774499973462400047793339],

		[2.54550971432895279624386048106669,3.26948797698562051517148994054930,-36.6237863834465893201859433547440],
	]},
	{x: (7+Math.sqrt(7))/2, y:(7+Math.sqrt(7))/2, n:18, coords:[
		[0,0,0],//done
		[0,1,0],//done
		[(7+Math.sqrt(7))/2-1,0,0],
		[(7+Math.sqrt(7))/2-2,0,0],
		[(7+Math.sqrt(7))/2-3,0,0],
		[(7+Math.sqrt(7))/2-1,1,0],
		[(7+Math.sqrt(7))/2-2,1,0],
		[0,(7+Math.sqrt(7))/2-2,0],
		[0,(7+Math.sqrt(7))/2-1,0],
		[1,(7+Math.sqrt(7))/2-1,0],
		[(7+Math.sqrt(7))/2-1,(7+Math.sqrt(7))/2-1,0],
		[(7+Math.sqrt(7))/2-2,(7+Math.sqrt(7))/2-1,0],
		[(7+Math.sqrt(7))/2-1,(7+Math.sqrt(7))/2-2,0],
		[(7+Math.sqrt(7))/2-2,(7+Math.sqrt(7))/2-2,0],
		[1-0.3085783708246108,0.3085783708246108/0.45141622964513656+2,-65.70481105463543],
		[1-0.3085783708246108 + 0.4114378277661477 ,0.3085783708246108/0.45141622964513656 - 0.9114378277661477+2,-65.70481105463543],
		[(7+Math.sqrt(7))/2-2 + 0.3085783708246108 - 0.4114378277661477 - 0.9114378277661477,(7+Math.sqrt(7))/2-2 - 0.3085783708246108/0.45141622964513656 + 0.9114378277661477 - 0.4114378277661477,-65.70481105463543],
		[(7+Math.sqrt(7))/2-2 + 0.3085783708246108 - 0.4114378277661477*2 - 0.9114378277661477,(7+Math.sqrt(7))/2-2 - 0.3085783708246108/0.45141622964513656 + 0.9114378277661477*2 - 0.4114378277661477,-65.70481105463543],
	]},
	{x: 3 + 4*s1/3, y: 3 + 4*s1/3, n:19, coords:[
		[0,0,0],
		[0,1,0],
		[1,0,0],

		[2 + 4*s1/3,0,0],

		[2 + 4*s1/3,2 + 4*s1/3,0],
		[2 + 4*s1/3,1 + 4*s1/3,0],
		[2 + 4*s1/3,4*s1/3,0],

		[1 + 4*s1/3,2 + 4*s1/3,0],
		[1 + 4*s1/3,1 + 4*s1/3,0],

		[4*s1/3,2 + 4*s1/3,0],

		[0,2 + 4*s1/3,0],

		[1+(4*s1/3 - 1)/2,2 + 4*s1/3 + (4*s1/3 - 1)/2,-135],
		[1+(4*s1/3 - 1)/2-s2,2 + 4*s1/3 + (4*s1/3 - 1)/2-s2,-135],

		[1+(4*s1/3 - 1)/2+(1/2-s1/3)+s2,2 + 4*s1/3 + (4*s1/3 - 1)/2+(1/2-s1/3)-s2,-135],
		[1+(4*s1/3 - 1)/2-s2+(1/2-s1/3)+s2,2 + 4*s1/3 + (4*s1/3 - 1)/2-s2+(1/2-s1/3)-s2,-135],

		[2 + 4*s1/3 + (4*s1/3 - 1)/2,1+(4*s1/3 - 1)/2,135],
		[2 + 4*s1/3 + (4*s1/3 - 1)/2-s2,1+(4*s1/3 - 1)/2-s2,135],

		[2 + 4*s1/3 + (4*s1/3 - 1)/2+(1/2-s1/3)-s2,1+(4*s1/3 - 1)/2+(1/2-s1/3)+s2,135],
		[2 + 4*s1/3 + (4*s1/3 - 1)/2-s2+(1/2-s1/3)-s2,1+(4*s1/3 - 1)/2-s2+(1/2-s1/3)+s2,135],
	]},
	{x: 5+s2, y:5+s2, n:27, coords:[
		[0,0,0],
		[1,0,0],
		[2,0,0],
		[3,0,0],
		[0,1,0],
		[1,1,0],
		[2,1,0],
		[0,2,0],
		[1,2,0],
		[0,3,0],

		[5+s2-1,5+s2-1,0],
		[5+s2-2,5+s2-1,0],
		[5+s2-3,5+s2-1,0],
		[5+s2-4,5+s2-1,0],
		[5+s2-1,5+s2-2,0],
		[5+s2-2,5+s2-2,0],
		[5+s2-3,5+s2-2,0],
		[5+s2-1,5+s2-3,0],
		[5+s2-2,5+s2-3,0],
		[5+s2-1,5+s2-4,0],

		[0,5+s2-1,0],
		[5+s2-1,0,0],

		[1-s2/2,4+s2/2,-45],
		[1-s2/2+s2,4+s2/2-s2,-45],
		[1-s2/2+s2*2,4+s2/2-s2*2,-45],
		[1-s2/2+s2*3,4+s2/2-s2*3,-45],
		[1-s2/2+s2*4,4+s2/2-s2*4,-45],
	]},
	{x: 5.934392385433883, y: 5.934392385433883, n:29, coords:[
		[0,0,0],
		[1,0,0],
		[0,1,0],
		[5.934392385433883-1,0,0],
		[5.934392385433883-2,0,0],
		[5.934392385433883-3,0,0],
		[0,5.934392385433883-1,0],
		[1,5.934392385433883-1,0],
		[5.934392385433883-1,5.934392385433883-1,0],
		[5.934392385433883-2,5.934392385433883-1,0],
		[5.934392385433883-3,5.934392385433883-1,0],
		[5.9343923854338831-1,5.934392385433883-2,0],
		[5.934392385433883-2,5.934392385433883-2,0],
		[5.934392385433883-1,5.934392385433883-3,0],

		[2.205,3.948,18.237505152074221178242697407128],
		[1.255,3.636,18.237505152074221178242697407128],
		[0.312,3.304,18.237505152074221178242697407128],
		[3.122,3.197,18.237505152074221178242697407128],
		[2.1723,2.885,18.237505152074221178242697407128],
		[1.229,2.553,18.237505152074221178242697407128],
		[0.312,2.142,18.237505152074221178242697407128],

		[1.249,1.372,21.630726313643649575092123487519],

		[2.18,0.63,26.001192984238322670663761654164],

		[4.053,2.435,20.33],
		[3.11,2.102,20.33],
		[2.159,1.789,20.33],

		[4.997,1.649,20.26],
		[4.0585,1.303,20.26],
		[3.105,1,20.26],
	]},
	{x: 3 + s1*2, y:3 + s1*2, n:28, coords:[
		[0,0,0],
		[1,0,0],
		[0,1,0],

		[3 + s1*2 - 1,0,0],
		[3 + s1*2 - 2,0,0],
		[3 + s1*2 - 1,1,0],

		[3 + s1*2 - 1,3 + s1*2 - 1,0],
		[3 + s1*2 - 2,3 + s1*2 - 1,0],
		[3 + s1*2 - 1,3 + s1*2 - 2,0],

		[0,3 + s1*2 - 1,0],
		[1,3 + s1*2 - 1,0],
		[0,3 + s1*2 - 2,0],

		[1-((3+s1*2)/2 - 2),2+((3+s1*2)/2 - 2),-45],[1-((3+s1*2)/2 - 2)+s2,2+((3+s1*2)/2 - 2)-s2,-45],[1-((3+s1*2)/2 - 2)+s2*2,2+((3+s1*2)/2 - 2)-s2*2,-45],[1-((3+s1*2)/2 - 2)+s2*3,2+((3+s1*2)/2 - 2)-s2*3,-45],
		[1-((3+s1*2)/2 - 2)+s2,2+((3+s1*2)/2 - 2)+s2,-45],[1-((3+s1*2)/2 - 2)+s2+s2,2+((3+s1*2)/2 - 2)-s2+s2,-45],[1-((3+s1*2)/2 - 2)+s2+s2*2,2+((3+s1*2)/2 - 2)-s2*2+s2,-45],[1-((3+s1*2)/2 - 2)+s2+s2*3,2+((3+s1*2)/2 - 2)-s2*3+s2,-45],
		[1-((3+s1*2)/2 - 2)+s1,2+((3+s1*2)/2 - 2)+s1,-45],[1-((3+s1*2)/2 - 2)+s2+s1,2+((3+s1*2)/2 - 2)-s2+s1,-45],[1-((3+s1*2)/2 - 2)+s2*2+s1,2+((3+s1*2)/2 - 2)-s2*2+s1,-45],[1-((3+s1*2)/2 - 2)+s2*3+s1,2+((3+s1*2)/2 - 2)-s2*3+s1,-45],
		[1-((3+s1*2)/2 - 2)+s2*3,2+((3+s1*2)/2 - 2)+s2*3,-45],[1-((3+s1*2)/2 - 2)+s2+s2*3,2+((3+s1*2)/2 - 2)-s2+s2*3,-45],[1-((3+s1*2)/2 - 2)+s2*2+s2*3,2+((3+s1*2)/2 - 2)-s2*2+s2*3,-45],[1-((3+s1*2)/2 - 2)+s2*3+s2*3,2+((3+s1*2)/2 - 2)-s2*3+s2*3,-45],
	]},
	{x: 6.59861960924436011617837046268, y: 6.59861960924436011617837046268, n:37, coords:[
		[0,0,0],
		[1,0,0],
		[0,1,0],

		[6.59861960924436011617837046268-1,6.59861960924436011617837046268-1,0],
		[6.59861960924436011617837046268-1,6.59861960924436011617837046268-2,0],
		[6.59861960924436011617837046268-2,6.59861960924436011617837046268-1,0],

		[6.59861960924436011617837046268-3,0,0],
		[6.59861960924436011617837046268-2,0,0],
		[6.59861960924436011617837046268-1,0,0],
		[6.59861960924436011617837046268-2,1,0],
		[6.59861960924436011617837046268-1,1,0],
		[6.59861960924436011617837046268-1,2,0],

		[0,6.59861960924436011617837046268-4,0],
		[0,6.59861960924436011617837046268-3,0],
		[0,6.59861960924436011617837046268-2,0],
		[0,6.59861960924436011617837046268-1,0],
		[1,6.59861960924436011617837046268-3,0],
		[1,6.59861960924436011617837046268-2,0],
		[1,6.59861960924436011617837046268-1,0],
		[2,6.59861960924436011617837046268-2,0],
		[2,6.59861960924436011617837046268-1,0],
		[3,6.59861960924436011617837046268-1,0],


		[2,6.59861960924436011617837046268-2-s2,-45],
		[2+s2,6.59861960924436011617837046268-2-s1,-45],
		[2+s1,6.59861960924436011617837046268-2-s2*3,-45],

		[0.702236622111675543312166010545,2.32969614911279769616252407621,-47.9133925257940968951470647263],
		[0.702236622111675543312166010545+0.742132528683414-0.048177368919081656,2.32969614911279769616252407621+0.6702531684893117+0.05334401134099515,-47.9133925257940968951470647263],

		[0.702236622111675543312166010545+0.6702531684893117+0.05334401134099515,2.32969614911279769616252407621-0.742132528683414+0.048177368919081656,-47.9133925257940968951470647263],
		[0.702236622111675543312166010545+0.6702531684893117*2+0.05334401134099515,2.32969614911279769616252407621-0.742132528683414*2+0.048177368919081656,-47.9133925257940968951470647263],

		[0.702236622111675543312166010545+0.6702531684893117+0.742132528683414+0.05334401134099515-0.048177368919081656,2.32969614911279769616252407621-0.742132528683414+0.6702531684893117+0.048177368919081656+0.05334401134099515,-47.9133925257940968951470647263],
		[0.702236622111675543312166010545+0.6702531684893117*2+0.742132528683414+0.05334401134099515-0.048177368919081656,2.32969614911279769616252407621-0.742132528683414*2+0.6702531684893117+0.048177368919081656+0.05334401134099515,-47.9133925257940968951470647263],

		[4.268923460131562,5.896382987132684,47.9133925257940968951470647263+180],[3.5453262803012553,5.202427827368352,47.9133925257940968951470647263+180],[4.9628786198958945,5.172785807302378,47.9133925257940968951470647263+180],[5.705011148579309,4.502532638813065,47.9133925257940968951470647263+180],[4.239281440065588,4.478830647538045,47.9133925257940968951470647263+180],[4.981413968749002,3.8085774790487332,47.9133925257940968951470647263+180],

	]},
	{x: 6.81880916998841064761025160207, y: 6.81880916998841064761025160207, n:39, coords:[
		[0,0,0],
		[6.81880916998841064761025160207-5,0,0],
		[6.81880916998841064761025160207-4,0,0],
		[6.81880916998841064761025160207-3,0,0],
		[6.81880916998841064761025160207-2,0,0],
		[6.81880916998841064761025160207-1,0,0],
		[6.81880916998841064761025160207-3,1,0],
		[6.81880916998841064761025160207-2,1,0],
		[6.81880916998841064761025160207-1,1,0],
		[6.81880916998841064761025160207-2,2,0],
		[6.81880916998841064761025160207-1,2,0],
		[6.81880916998841064761025160207-1,3,0],
		[6.81880916998841064761025160207-1,4,0],
		[6.81880916998841064761025160207-1,6.81880916998841064761025160207-1,0],

		[0,6.81880916998841064761025160207-5,0],
		[0,6.81880916998841064761025160207-4,0],
		[0,6.81880916998841064761025160207-3,0],
		[0,6.81880916998841064761025160207-2,0],
		[0,6.81880916998841064761025160207-1,0],
		[1,6.81880916998841064761025160207-4,0],
		[1,6.81880916998841064761025160207-3,0],
		[1,6.81880916998841064761025160207-2,0],
		[1,6.81880916998841064761025160207-1,0],
		[2,6.81880916998841064761025160207-4,0],
		[2,6.81880916998841064761025160207-3,0],
		[2,6.81880916998841064761025160207-2,0],
		[2,6.81880916998841064761025160207-1,0],
		[3,6.81880916998841064761025160207-3,0],
		[3,6.81880916998841064761025160207-2,0],
		[3,6.81880916998841064761025160207-1,0],
		[4,6.81880916998841064761025160207-1,0],
		[0.606178916907446991536015279942,1.29752487849617258102379445303,-37.0704032278038098879880651871],
		[0.606178916907446991536015279942+0.6027959064351964+0.0986211532364433,1.29752487849617258102379445303+0.797895416194986-0.07450654089773404,-37.0704032278038098879880651871],
		[0.606178916907446991536015279942+0.6027959064351964+0.0986211532364433+0.797895416194986+0.1395210146097507,1.29752487849617258102379445303+0.797895416194986-0.07450654089773404-0.6027959064351964+0.18467805907696813,-37.0704032278038098879880651871],
		[0.606178916907446991536015279942+0.6027959064351964*2+0.1395210146097507+0.7923060997241951,1.29752487849617258102379445303+0.797895416194986*2-0.5985732764764597+0.18467805907696813,-37.0704032278038098879880651871],

[5.521284291492238,6.212630253080964,180+37.0704032278038098879880651871],[4.7978954161949865,5.511213193409324,180+37.0704032278038098879880651871],[5.216013263553215,4.573796762604587,180+37.0704032278038098879880651871],[4.339388676501757,4.075211325876625,180+37.0704032278038098879880651871]
	]},
	{x: 6.93786550630255624147730819348, y: 6.93786550630255624147730819348, n:41, coords:[
		[0,0,0],[1,0,0],[2,0,0],
		[0,1,0],[1,1,0],
		[0,2,0],

		[6.93786550630255624147730819348-1,6.93786550630255624147730819348-1,0],[6.93786550630255624147730819348-2,6.93786550630255624147730819348-1,0],[6.93786550630255624147730819348-3,6.93786550630255624147730819348-1,0],
		[6.93786550630255624147730819348-1,6.93786550630255624147730819348-2,0],[6.93786550630255624147730819348-2,6.93786550630255624147730819348-2,0],
		[6.93786550630255624147730819348-1,6.93786550630255624147730819348-3,0],

		[6.93786550630255624147730819348-1,0,0],[6.93786550630255624147730819348-2,0,0],[6.93786550630255624147730819348-3,0,0],

		[0,6.93786550630255624147730819348-1,0],[1,6.93786550630255624147730819348-1,0],[2,6.93786550630255624147730819348-1,0],

		[3.07655182611575235268251737376,0.743221622645560469944136502298,16.6005875427289946586844120622],
		[3.07655182611575235268251737376+0.9583196448076368,0.743221622645560469944136502298+0.28569819456161233,16.6005875427289946586844120622],
		[3.07655182611575235268251737376+0.9583196448076368*2,0.743221622645560469944136502298+0.28569819456161233*2,16.6005875427289946586844120622],
		[3.07655182611575235268251737376+0.9583196448076368*3,0.743221622645560469944136502298+0.28569819456161233*3,16.6005875427289946586844120622],

		[3.07655182611575235268251737376-0.28569819456161233-0.6445863492897672 ,0.743221622645560469944136502298+0.9583196448076368 -0.19216673395870254 ,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233-0.6445863492897672+0.9583196448076368,0.743221622645560469944136502298+0.9583196448076368 -0.19216673395870254+0.28569819456161233,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233-0.6445863492897672+0.9583196448076368*2,0.743221622645560469944136502298+0.9583196448076368 -0.19216673395870254+0.28569819456161233*2,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233-0.6445863492897672+0.9583196448076368*3,0.743221622645560469944136502298+0.9583196448076368 -0.19216673395870254+0.28569819456161233*3,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233-0.6445863492897672+0.9583196448076368*4,0.743221622645560469944136502298+0.9583196448076368 -0.19216673395870254+0.28569819456161233*4,16.6005875427289946586844120622],

		[3.07655182611575235268251737376-0.28569819456161233*2-0.6445863492897672*2 ,0.743221622645560469944136502298+0.9583196448076368*2 -0.19216673395870254*2 ,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233*2-0.6445863492897672*2+0.9583196448076368,0.743221622645560469944136502298+0.9583196448076368*2 -0.19216673395870254*2+0.28569819456161233,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233*2-0.6445863492897672*2+0.9583196448076368*2,0.743221622645560469944136502298+0.9583196448076368*2 -0.19216673395870254*2+0.28569819456161233*2,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233*2-0.6445863492897672*2+0.9583196448076368*3,0.743221622645560469944136502298+0.9583196448076368*2 -0.19216673395870254*2+0.28569819456161233*3,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233*2-0.6445863492897672*2+0.9583196448076368*4,0.743221622645560469944136502298+0.9583196448076368*2 -0.19216673395870254*2+0.28569819456161233*4,16.6005875427289946586844120622],

		[3.07655182611575235268251737376-0.28569819456161233*3-0.6445863492897672*3 ,0.743221622645560469944136502298+0.9583196448076368*3 -0.19216673395870254*3 ,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233*3-0.6445863492897672*3+0.9583196448076368,0.743221622645560469944136502298+0.9583196448076368*3 -0.19216673395870254*3+0.28569819456161233,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233*3-0.6445863492897672*3+0.9583196448076368*2,0.743221622645560469944136502298+0.9583196448076368*3 -0.19216673395870254*3+0.28569819456161233*2,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233*3-0.6445863492897672*3+0.9583196448076368*3,0.743221622645560469944136502298+0.9583196448076368*3 -0.19216673395870254*3+0.28569819456161233*3,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233*3-0.6445863492897672*3+0.9583196448076368*4,0.743221622645560469944136502298+0.9583196448076368*3 -0.19216673395870254*3+0.28569819456161233*4,16.6005875427289946586844120622],

		[3.07655182611575235268251737376-0.28569819456161233*4-0.6445863492897672*4+0.9583196448076368,0.743221622645560469944136502298+0.9583196448076368*4 -0.19216673395870254*4+0.28569819456161233,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233*4-0.6445863492897672*4+0.9583196448076368*2,0.743221622645560469944136502298+0.9583196448076368*4 -0.19216673395870254*4+0.28569819456161233*2,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233*4-0.6445863492897672*4+0.9583196448076368*3,0.743221622645560469944136502298+0.9583196448076368*4 -0.19216673395870254*4+0.28569819456161233*3,16.6005875427289946586844120622],
		[3.07655182611575235268251737376-0.28569819456161233*4-0.6445863492897672*4+0.9583196448076368*4,0.743221622645560469944136502298+0.9583196448076368*4 -0.19216673395870254*4+0.28569819456161233*4,16.6005875427289946586844120622],
	]},
	{x: 7.84666719284348978294331459096, y: 7.84666719284348978294331459096, n:54, coords:[
		[0,0,0],[1,0,0],[2,0,0],[3,0,0],[4,0,0],[5,0,0],   [6.84666719284348978294331459096,0,0],
		[0,1,0],[1,1,0],[2,1,0],[3,1,0],[4,1,0],
		[0,2,0],[1,2,0],[2,2,0],[3,2,0],
		[0,3,0],[1,3,0],
		[0,4,0],
		[0,6.84666719284348978294331459096,0],
		[7.84666719284348978294331459096-1,7.84666719284348978294331459096-1],
		[7.84666719284348978294331459096-2,7.84666719284348978294331459096-1],
		[7.84666719284348978294331459096-3,7.84666719284348978294331459096-1],
		[7.84666719284348978294331459096-4,7.84666719284348978294331459096-1],
		[7.84666719284348978294331459096-5,7.84666719284348978294331459096-1],
		[7.84666719284348978294331459096-6,7.84666719284348978294331459096-1],
		[7.84666719284348978294331459096-1,7.84666719284348978294331459096-2],
		[7.84666719284348978294331459096-2,7.84666719284348978294331459096-2],
		[7.84666719284348978294331459096-3,7.84666719284348978294331459096-2],
		[7.84666719284348978294331459096-4,7.84666719284348978294331459096-2],
		[7.84666719284348978294331459096-5,7.84666719284348978294331459096-2],
		[7.84666719284348978294331459096-1,7.84666719284348978294331459096-3],
		[7.84666719284348978294331459096-2,7.84666719284348978294331459096-3],
		[7.84666719284348978294331459096-3,7.84666719284348978294331459096-3],
		[7.84666719284348978294331459096-4,7.84666719284348978294331459096-3],
		[7.84666719284348978294331459096-1,7.84666719284348978294331459096-4],
		[7.84666719284348978294331459096-2,7.84666719284348978294331459096-4],
		[7.84666719284348978294331459096-1,7.84666719284348978294331459096-5],

		[0,6,-55.2650997396489041743253949403],
		[0.75,6.67333359642174489147165729548,-55.2650997396489041743253949403],
		[0.776886987015018653672079476532,5.32179712645279131236772171871,-55.2650997396489041743253949403],
		[1.52688698701501865367207947653,5.99513072287453620383937901419,-55.2650997396489041743253949403],
		[1.55377397403003730734415895306,4.64359425290558262473544343742,-55.2650997396489041743253949403],
		[1.55377397403003730734415895306+0.5697802058284711,4.64359425290558262473544343742-0.8217971264527913 ,-55.2650997396489041743253949403],
		[1.55377397403003730734415895306+0.5697802058284711+0.8217971264527913-0.04403541977910971 ,4.64359425290558262473544343742-0.8217971264527913+0.5697802058284711+0.0635125282809649 ,-55.2650997396489041743253949403],
		[1.55377397403003730734415895306+0.8217971264527913-0.04403541977910971 ,4.64359425290558262473544343742+0.5697802058284711+0.0635125282809649 ,-55.2650997396489041743253949403],

		[7.84666719284349,1.8466671928434897,124.7349002603511],[7.09666719284349,1.1733335964217444,124.7349002603511],[7.069780205828471,2.524870066390698,124.7349002603511],[6.319780205828471,1.8515364699689538,124.7349002603511],[6.292893218813452,3.2030729399379068,124.7349002603511],[5.723113012984982,4.024870066390698,124.7349002603511],[4.9453513063112995,3.391577332281262,124.7349002603511],[5.515131512139771,2.5697802058284704,124.7349002603511],
	]},
	{x: 7.7043537294712480587948008253319, y: 6.7043537294712480587948008253319, n:44, coords:[
		[0,0,0],[1,0,0],[2,0,0],
		[0,1,0],[1,1,0],
		[0,2,0],

		[7.7043537294712480587948008253319-1,6.7043537294712480587948008253319-1,0],
		[7.7043537294712480587948008253319-2,6.7043537294712480587948008253319-1,0],
		[7.7043537294712480587948008253319-3,6.7043537294712480587948008253319-1,0],
		[7.7043537294712480587948008253319-1,6.7043537294712480587948008253319-2,0],
		[7.7043537294712480587948008253319-2,6.7043537294712480587948008253319-2,0],
		[7.7043537294712480587948008253319-1,6.7043537294712480587948008253319-3,0],

		[0,6.7043537294712480587948008253319-1,0],
		[1,6.7043537294712480587948008253319-1,0],
		[2,6.7043537294712480587948008253319-1,0],
		[3,6.7043537294712480587948008253319-1,0],
		[0,6.7043537294712480587948008253319-2,0],
		[1,6.7043537294712480587948008253319-2,0],

		[7.7043537294712480587948008253319-1,0,0],
		[7.7043537294712480587948008253319-2,0,0],
		[7.7043537294712480587948008253319-3,0,0],
		[7.7043537294712480587948008253319-4,0,0],
		[7.7043537294712480587948008253319-1,1,0],
		[7.7043537294712480587948008253319-2,1,0],

		[0,6.7043537294712480587948008253319-3.5844480062227340260437408858475,0],
		[7.7043537294712480587948008253319-1,2.5844480062227340260437408858475,0],


		[1-0.031847307148060985 - 0.009921506924910877,  3+0.07850438277592381   + 0.02445675465514529,22.081190702314005994975381503164-90],
		[1-0.06557890263350168    + 0.9266520894150851,  3+0.16165358190037435   + 0.375920078185054,22.081190702314005994975381503164-90],
		[1-0.09554192144418296    + 0.9266520894150851*2,3+0.23551314832777145   + 0.375920078185054*2,22.081190702314005994975381503164-90],
		[1-0.12550494025486422    + 0.9266520894150851*3,3+0.30937271475516853   + 0.375920078185054*3,22.081190702314005994975381503164-90],
		[1-0.14931502881539402    + 0.9266520894150851*4,3+0.36806515922447375   + 0.375920078185054*4,22.081190702314005994975381503164-90],

		[6.74612254354422,3.601392592040179,112.081190702314],[5.843280542689665,3.16678006938582,112.081190702314],[4.946591472085261,2.7170004247733686,112.081190702314],[4.049902401480857,2.267220780160917,112.081190702314],[3.1470604006263017,1.8326082575065579,112.081190702314],

		[3.1764541908891125931613422553707,0.69479500995028506949773051869691,30.034343572497740605438658550210],
		[3.1764541908891125931613422553707 + 0.038539964005824406    +0.86572554401657,  0.69479500995028506949773051869691 - 0.06666086688927589     +0.5005190130626547,30.034343572497740605438658550210],
		[3.1764541908891125931613422553707 + 0.06772647000012444     +0.86572554401657*2,0.69479500995028506949773051869691 - 0.11714347218582094     +0.5005190130626547*2,30.034343572497740605438658550210],
		[3.1764541908891125931613422553707 + 0.09810172656028032     +0.86572554401657*3,0.69479500995028506949773051869691 - 0.16968220662724773     +0.5005190130626547*3,30.034343572497740605438658550210],

		[4.527899538582135,6.009558719520963,210.03434357249773],[3.6236340305597405,5.575700573347584,210.03434357249773],[2.7287219805488707,5.125664165581474,210.03434357249773],[1.8326211799721452,4.677683886960247,210.03434357249773]

	]},
	{x: 9.90177651254408159158404329257, y: 9.90177651254408159158404329257, n:88, coords:[
		[0,0,0],[1,0,0],[2,0,0],[3,0,0],[4,0,0],[5,0,0],[6,0,0],
		[0,1,0],[1,1,0],[2,1,0],[3,1,0],[4,1,0],[5,1,0],
		[0,2,0],[1,2,0],[2,2,0],[3,2,0],[4,2,0],
		[0,3,0],[1,3,0],[2,3,0],[3,3,0],
		[0,4,0],[1,4,0],[2,4,0],
		[0,5,0],[1,5,0],
		[0,6,0],

		[9.90177651254408159158404329257-1,0,0],
		[0,9.90177651254408159158404329257-1,0],

		[9.90177651254408159158404329257-1,9.90177651254408159158404329257-1,0],[9.90177651254408159158404329257-2,9.90177651254408159158404329257-1,0],[9.90177651254408159158404329257-3,9.90177651254408159158404329257-1,0],[9.90177651254408159158404329257-4,9.90177651254408159158404329257-1,0],[9.90177651254408159158404329257-5,9.90177651254408159158404329257-1,0],[9.90177651254408159158404329257-6,9.90177651254408159158404329257-1,0],[9.90177651254408159158404329257-7,9.90177651254408159158404329257-1,0],[9.90177651254408159158404329257-8,9.90177651254408159158404329257-1,0],
		[9.90177651254408159158404329257-1,9.90177651254408159158404329257-2,0],[9.90177651254408159158404329257-2,9.90177651254408159158404329257-2,0],[9.90177651254408159158404329257-3,9.90177651254408159158404329257-2,0],[9.90177651254408159158404329257-4,9.90177651254408159158404329257-2,0],[9.90177651254408159158404329257-5,9.90177651254408159158404329257-2,0],[9.90177651254408159158404329257-6,9.90177651254408159158404329257-2,0],[9.90177651254408159158404329257-7,9.90177651254408159158404329257-2,0],
		[9.90177651254408159158404329257-1,9.90177651254408159158404329257-3,0],[9.90177651254408159158404329257-2,9.90177651254408159158404329257-3,0],[9.90177651254408159158404329257-3,9.90177651254408159158404329257-3,0],[9.90177651254408159158404329257-4,9.90177651254408159158404329257-3,0],[9.90177651254408159158404329257-5,9.90177651254408159158404329257-3,0],[9.90177651254408159158404329257-6,9.90177651254408159158404329257-3,0],
		[9.90177651254408159158404329257-1,9.90177651254408159158404329257-4,0],[9.90177651254408159158404329257-2,9.90177651254408159158404329257-4,0],[9.90177651254408159158404329257-3,9.90177651254408159158404329257-4,0],[9.90177651254408159158404329257-4,9.90177651254408159158404329257-4,0],[9.90177651254408159158404329257-5,9.90177651254408159158404329257-4,0],
		[9.90177651254408159158404329257-1,9.90177651254408159158404329257-5,0],[9.90177651254408159158404329257-2,9.90177651254408159158404329257-5,0],[9.90177651254408159158404329257-3,9.90177651254408159158404329257-5,0],[9.90177651254408159158404329257-4,9.90177651254408159158404329257-5,0],
		[9.90177651254408159158404329257-1,9.90177651254408159158404329257-6,0],[9.90177651254408159158404329257-2,9.90177651254408159158404329257-6,0],[9.90177651254408159158404329257-3,9.90177651254408159158404329257-6,0],
		[9.90177651254408159158404329257-1,9.90177651254408159158404329257-7,0],[9.90177651254408159158404329257-2,9.90177651254408159158404329257-7,0],
		[9.90177651254408159158404329257-1,9.90177651254408159158404329257-8,0],

		[0,7.95211008475280572289809528644,-46.4788482642050369022527419769],
		[0.7251202034982782,7.95211008475280572289809528644+0.688622313375493,-46.4788482642050369022527419769],
		[0.688622313375493+0.0742914787965393,7.95211008475280572289809528644-0.7251202034982782+0.0705521232840408,-46.4788482642050369022527419769],
		[0.688622313375493+0.0742914787965393+0.7251202034982782,7.95211008475280572289809528644-0.7251202034982782+0.0705521232840408+0.688622313375493,-46.4788482642050369022527419769],

		[1.50186967775624925435202266771,6.52453188579309577094649362235,-46.4788482642050369022527419769],
		[1.50186967775624925435202266771+0.7251202034982782,6.52453188579309577094649362235+0.688622313375493,-46.4788482642050369022527419769],
		[1.50186967775624925435202266771+0.688622313375493,6.52453188579309577094649362235-0.7251202034982782,-46.4788482642050369022527419769],
		[1.50186967775624925435202266771+0.7251202034982782+0.688622313375493,6.52453188579309577094649362235+0.688622313375493-0.7251202034982782,-46.4788482642050369022527419769],


		[1.50186967775624925435202266771+0.688622313375493*2+0.02646535751309189,6.52453188579309577094649362235-0.7251202034982782*2+0.025133261529676983,-46.4788482642050369022527419769],
		[1.50186967775624925435202266771+0.688622313375493*2+0.02646535751309189+0.7251202034982782,6.52453188579309577094649362235-0.7251202034982782*2+0.025133261529676983+0.688622313375493,-46.4788482642050369022527419769],


		[9.90177651254408159158404329257-4-s2,9.90177651254408159158404329257-4,-135],
		[9.90177651254408159158404329257-4-s1,9.90177651254408159158404329257-4-s2,-135],

[7.952110084752806,0,46.478848264205034],[8.640732398128298,0.7251202034982782,46.478848264205034],[7.297542004538569,0.7629137921720323,46.478848264205034],[7.986164317914062,1.4880339956703104,46.478848264205034],[6.524531885793095,1.5018696777562492,46.478848264205034],[7.213154199168589,2.2269898812545277,46.478848264205034],[5.799411682294817,2.190491991131742,46.478848264205034],[6.48803399567031,2.915612194630021,46.478848264205034],[5.099424740326216,2.905579662020327,46.478848264205034],[5.7880470537017095,3.630699865518605,46.478848264205034],

	]}
]

function transpose(list){
	return list.map(a => [a[1],a[0],-a[2]]);
}

function translate(list,x,y){
	return list.map(a => [a[0] + x,a[1] + y,a[2]]);
}

function gen_slant3(width,height){
	let angle = Math.asin(height/Math.sqrt(10)) - Math.asin(1/Math.sqrt(10));
	let c = Math.cos(Math.PI/2 - angle);
	let s = Math.sin(Math.PI/2 - angle);
	let end_cap = c + 3 * s;
	let safety1 = 3*s - s/c - 1;
	let safety2 = (s + c -1)*c/s + s - 1;
	let safetyFix = Math.min(safety1,safety2);
	end_cap -= safetyFix;
	if(end_cap < width){
		let units = Math.floor((width - end_cap) * c);
		let coords = [[0,0,0]];
		let base = height - s;
		let slag = width - end_cap - units/c;
		base = height - s + c/s * slag;
		let counter = 0;
		let ang = 180*((angle)/Math.PI)
		while(base > 0){
			base -= c/s;
			counter++
			for(let i=0;i<Math.max(0,Math.floor(base));i++){
				coords.push([width - counter,height - i - 1,0])
			}
		}
		for(let i=0;i<=units;i++){
			for(let j=0;j<3;j++){
				if(i === 0 && j === 0){
					coords.push([0,height - 1,0])
				}
				else{
					coords.push([i/c + j*s-safetyFix,height - s - j*c,-ang])
				}
			}
		}
		return coords;
	}
	return []
}

function gen_slant(width,height){
	if(height < 3){
		return gen_slant3(width,height)
	}
	let base_len = Math.floor(height) + 1;
	let angle = Math.asin(height/Math.sqrt(base_len*base_len + 1)) - Math.asin(1/Math.sqrt(base_len*base_len + 1));
	let c = Math.cos(Math.PI/2 - angle);
	let s = Math.sin(Math.PI/2 - angle);
	let end_cap = c + base_len * s;
	if(end_cap < width){
		let units = Math.floor((width - end_cap) * c);
		let coords = [];
		let base = height - s;
		let counter = 0;
		let mini = [];
		while(base > 0){
			base -= c/s;
			for(let i=0;i<Math.max(0,Math.floor(base));i++){
				mini.push([counter,i,0])
			}
			counter++
		}
		let mini2 = [];
		base = base_len;
		counter = 0;
		let ang = 180*((angle)/Math.PI)
		while(base > 0){
			base -= c/s + s/c;
			counter++;
			for(let i=0;i<Math.max(0,Math.floor(base));i++){
				mini2.push([(base_len-1)*s - i*s - counter/c,i*c + c,-ang])
			}
		}
		if(mini2.length > mini.length){
			coords = coords.concat(mini2);
		}
		else{
			coords = coords.concat(mini);
		}
		let slag = width - end_cap - units/c;
		base = height - s + c/s * slag;
		counter = 0;
		while(base > 0){
			base -= c/s;
			counter++
			for(let i=0;i<Math.max(0,Math.floor(base));i++){
				coords.push([width - counter,height - i - 1,0])
			}
		}
		for(let i=0;i<=units;i++){
			for(let j=0;j<base_len;j++){
				if(i === 0 && j === 0){
					coords.push([0,height - 1,0])
				}
				else{
					coords.push([i/c + j*s,height - s - j*c,-ang])
				}
			}
		}
		if(height - 1 > 1){
			let lesser = gen_slant(width,height - 1);
			if(lesser.length + Math.floor(width) > coords.length){
				coords = lesser;
				for(let i=0;i<Math.floor(width);i++){
					coords.push([i,height - 1,0])
				}
			}
		}
		return coords;
	}
	return []
}

function graham(width,height){
	let inner = Math.round(height - Math.pow(height,8/11));
	let section1 = gen_slant(width,height - inner);
	section1 = section1.concat(translate(transpose(gen_slant(inner,width - inner)), inner, height - inner));
	for(let i=0;i<inner;i++){
		for(let j=0;j<inner;j++){
			section1.push([i,height - inner + j,0])
		}
	}
	return section1
}

function getSquares(width,height,recursive){
	if(width < 1 || height < 1){
		return {
			coords: [],
			comment: "No squares fit",
			proven: true,
			ref: "trivial"
		}
	}
	if(height > width){
		let other = getSquares(height,width);
		other.coords = transpose(other.coords);
		return other
	}
	let record = {
			coords: [],
			comment: "Unknown",
			proven: false,
			ref: null
	}
	let lattice = generateLattice(0,0,width,height);
	if(lattice.length > record.coords){
		record.coords = lattice;
		record.comment = "Lattice";
		record.ref = "trivial";
		if(lattice.length === Math.floor(width*height)){
			record.proven = true;
			return record
		}
	}
	if(record.coords.length === Math.floor(width*height)){
		return record
	}
	/*if(height < 2 && width > 2 && width < 3){
		let w_gap = width - 2;
		if(s2 + 1 + (s1 - w_gap)/2 < height && record.coords.length < 3){
			record.coords = [
				[0,0,0],
				[width-1,0,0],
				[width/2,1-w_gap/2,45],
			]
		}
	}*/
	if(width > 2){
		let un_height = height - Math.floor(height) + 1;
		let w_gap = s1 - 2*(un_height - 1 - s2);
		if(2 + w_gap <= width){
			let unit_width = 2*s1 - un_height;
			let total = 3 + Math.floor((width - 2 - w_gap)/unit_width);
			if(record.coords.length < total + (Math.floor(height) - 1) * Math.floor(width)){
				record.coords = [
					[0,0,0],
					[1+w_gap/2,1-w_gap/2,45],
				];
				for(let i=0;i<total - 3;i++){
					if(i % 2){
						record.coords.push([1+w_gap/2 + unit_width + i*unit_width,un_height,-135])
					}
					else{
						record.coords.push([1+w_gap/2 + unit_width + i*unit_width,0,45])
					}
				}
				if(total % 2){
					record.coords.push([width - 1,0,0])
				}
				else{
					record.coords.push([width - 1,un_height - 1,0])
				}
				for(let i=0;i<Math.floor(width);i++){
					for(let j=0;j<Math.floor(height - 1);j++){
						record.coords.push([i,un_height + j,0])
					}
				}

			}
		}
	}
	if(width > 2 && height > 2 && (width + height - Math.floor(width) - Math.floor(height) >= Math.SQRT2)){//5, +2, +3, ...
		let h_gap = height - Math.floor(height);
		let w_gap = width - Math.floor(width);
		let cel_num = Math.min(Math.floor(height/2),Math.floor(Math.ceil(width)/3));
		record.coords = [];
		for(let c = 0;c<cel_num;c++){
			record.coords.push([c*3+0,c*2,0]);
			record.coords.push([c*3+1 + w_gap,c*2,0]);
			record.coords.push([c*3+1 + w_gap,c*2+1 + h_gap,0]);
			record.coords.push([c*3+0,c*2+1 + h_gap,0]);
			record.coords.push([c*3+1 - h_gap/2,c*2+1 + h_gap/2,-45]);
			if(c){
				for(let i=0;i<3;i++){
					for(let j=0;j<c*2;j++){
						record.coords.push([w_gap + c*3 - 1 + i,j,0])
					}
				}
				for(let i=0;i<2;i++){
					for(let j=0;j<c*3;j++){
						record.coords.push([j,h_gap + c*2 + i,0])
					}
				}
			}
		}
		for(let j=0;j<Math.floor(height - Math.floor(cel_num)*2 - h_gap);j++){
			for(let i=0;i<Math.floor(width);i++){
				record.coords.push([i,height - 1 - j,0])
			}
		}
		for(let i=0;i < Math.floor(width) - 3*cel_num + 1;i++){
			for(let j=0;j<cel_num*2;j++){
				record.coords.push([w_gap + cel_num*3 - 1 + i,j,0])
			}
		}
	}
	if(width > 4 && width < 5 && height > 2 + s2 && height < 3 && record.coords.length < 10 && width + height*2 >= 5 + 4*s1){
		let h_gap = height - Math.floor(height);
		let w_gap = width - Math.floor(width);
		record.coords = [
			[0,height - 2,0],
			[0,height - 1,0],
			[1,height - 1,0],
			[width - 1,height - 1,0],
			[width - 1,0,0],

			[width - 1 + h_gap/2,height/2,135],
			[width - 1 + h_gap/2 - s2,height/2 + s2,135],

			[1 - (h_gap - s2),s2,-45],
			[1 - (h_gap - s2)+s2,s1,-45],
			[1 - (h_gap - s2)+s1,s2,-45],
		]
	}
	if(width > 4 && width < 5 && height > 2 && height < 3 && record.coords.length < 9){
		let w_gap = width - 4;
		if(s1 + s2 + 1 - w_gap/2 <= height){
			record.coords = [
				[0,0,0],
				[1,0,0],
				[0,1,0],
				[width - 1,0,0],
				[width - 2,0,0],
				[width - 1,1,0],
				[width/2,1-w_gap/2,45],
				[width/2 - s2,1-w_gap/2 + s2,45],
				[width/2 + s2,1-w_gap/2 + s2,45],
			]
		}
	}
	if(width > 3 && height > 3 && record.coords.length < Math.floor(width) * Math.floor(height) + 1){
		let h_gap = height - Math.floor(height);
		let w_gap = width - Math.floor(width);
		let alf = (w_gap * h_gap * h_gap)/(w_gap*w_gap + h_gap*h_gap);
		let ang = Math.atan(h_gap/w_gap);
		let x1 = 1 - alf;
		let y1 = 1 + alf*h_gap/w_gap;
		let avs = x1 + Math.cos(ang) + Math.sin(ang) - (3 + w_gap)/2;
		let hogh = avs*h_gap/w_gap + y1 - Math.sin(ang) + Math.cos(ang);
		if(h_gap*h_gap + w_gap*w_gap >= 1 && hogh <= (3 + h_gap)/2){
			record.coords = [
				[0,0,0],
				[(3 + w_gap) - 1,0,0],
				[(3 + w_gap) - 2,0,0],
				[(3 + w_gap) - 1,1,0],
				[0,(3 + h_gap) - 2,0],
				[0,(3 + h_gap) - 1,0],
				[1,(3 + h_gap) - 1,0],
				[(3 + w_gap) - 1,(3 + h_gap) - 1,0],
				[x1,y1,-ang*180/Math.PI],
				[(3 + w_gap) - x1,(3 + h_gap) - y1,180 -ang*180/Math.PI],
			]
			for(let i=0;i<Math.floor(width - 3 - w_gap);i++){
				for(let j=0;j<Math.floor(3 + h_gap);j++){
					record.coords.push([3 + w_gap + i,j,0])
				}
			}
			for(let i=0;i<Math.floor(width);i++){
				for(let j=0;j<Math.floor(height - 3 - h_gap);j++){
					record.coords.push([i,j + 3 + h_gap,0])
				}
			}
		}
	}
	if(width > 7 && height > 6 && record.coords.length < Math.floor(width) * Math.floor(height) + 2){
		let h_gap = height - Math.floor(height);
		let w_gap = width - Math.floor(width);
		let alf = (w_gap * h_gap * h_gap)/(w_gap*w_gap + h_gap*h_gap);
		let ang = Math.atan(h_gap/w_gap);
		let x1 = 1 - alf;
		let y1 = 1 + alf*h_gap/w_gap;
		let avs = x1 + Math.cos(ang) + Math.sin(ang) - (3 + w_gap)/2;
		let hogh = avs*h_gap/w_gap + y1 - Math.sin(ang) + Math.cos(ang);
		if(h_gap*h_gap + w_gap*w_gap >= 1 && hogh <= (3 + h_gap)/2){
			record.coords = [
				[0,0,0],
				[(3 + w_gap) - 1,0,0],
				[(3 + w_gap) - 2,0,0],
				[(3 + w_gap) - 1,1,0],
				[0,(3 + h_gap) - 2,0],
				[0,(3 + h_gap) - 1,0],
				[1,(3 + h_gap) - 1,0],
				[(3 + w_gap) - 1,(3 + h_gap) - 1,0],
				[x1,y1,-ang*180/Math.PI],
				[(3 + w_gap) - x1,(3 + h_gap) - y1,180 -ang*180/Math.PI],

				[4,3,0],
				[4+(3 + w_gap) - 1,3,0],
				[4+(3 + w_gap) - 2,3,0],
				[4+(3 + w_gap) - 1,4,0],
				[4,(3 + h_gap) - 2+3,0],
				[4,(3 + h_gap) - 1+3,0],
				[5,(3 + h_gap) - 1+3,0],
				[4+(3 + w_gap) - 1,3+(3 + h_gap) - 1,0],
				[4+x1,3+y1,-ang*180/Math.PI],
				[4+(3 + w_gap) - x1,3+(3 + h_gap) - y1,180 -ang*180/Math.PI],

				[3+w_gap,0,0],
				[4+w_gap,0,0],
				[5+w_gap,0,0],
				[6+w_gap,0,0],
				[3+w_gap,1,0],
				[4+w_gap,1,0],
				[5+w_gap,1,0],
				[6+w_gap,1,0],
				[3+w_gap,2,0],
				[4+w_gap,2,0],
				[5+w_gap,2,0],
				[6+w_gap,2,0],

				[0,3+h_gap,0],
				[1,3+h_gap,0],
				[2,3+h_gap,0],
				[3,3+h_gap,0],
				[0,4+h_gap,0],
				[1,4+h_gap,0],
				[2,4+h_gap,0],
				[3,4+h_gap,0],
				[0,5+h_gap,0],
				[1,5+h_gap,0],
				[2,5+h_gap,0],
				[3,5+h_gap,0],
			]
			for(let i=0;i<Math.floor(width - 7 - w_gap);i++){
				for(let j=0;j<Math.floor(6 + h_gap);j++){
					record.coords.push([7 + w_gap + i,j,0])
				}
			}
			for(let i=0;i<Math.floor(width);i++){
				for(let j=0;j<Math.floor(height - 6 - h_gap);j++){
					record.coords.push([i,j + 6 + h_gap,0])
				}
			}
		}
	}
	if(width > 5 && height > 4 && (width + height - Math.floor(width) - Math.floor(height) >= 3*s1 - 3)){//21
		if(record.coords.length < Math.floor(width)*Math.floor(height) + 1){
			let h_gap = height - Math.floor(height);
			let w_gap = width - Math.floor(width);
			let boost = [
				[0,0,0],
				[1,0,0],
				[0,1,0],

				[3+w_gap,0,0],
				[4+w_gap,0,0],
				[4+w_gap,1,0],

				[3+w_gap,3+h_gap,0],
				[4+w_gap,3+h_gap,0],
				[4+w_gap,2+h_gap,0],

				[0,3+h_gap,0],
				[1,3+h_gap,0],
				[0,2+h_gap,0],
			];
			for(let i=0;i<3;i++){
				for(let j=0;j<3;j++){
					boost.push([1 - h_gap/2 + s2*(i+j), 2 + h_gap/2 + s2*(j-i),-45]);
				}
			}
			for(let i=0;i<Math.floor(width - 5 - w_gap);i++){
				for(let j=0;j<Math.floor(4 + h_gap);j++){
					boost.push([5 + w_gap + i,j,0])
				}
			}
			for(let i=0;i<Math.floor(width);i++){
				for(let j=0;j<Math.floor(height - 4 - h_gap);j++){
					boost.push([i,4 + h_gap + j,0])
				}
			}
			if(boost.length > record.coords.length){
				record.coords = boost
			}
		}
	}
	if(width > 8 && height > 8 && (width + height - Math.floor(width) - Math.floor(height) >= 10*s2 - 6)){//65
		let h_gap = height - Math.floor(height);
		let w_gap = width - Math.floor(width);
		let boost = [];
		[[0,0],[1,0],[2,0],[3,0],[0,1],[1,1],[2,1],[0,2],[1,2],[0,3]].forEach(loc => {
			boost.push([loc[0],loc[1],0]);
			boost.push([8 + w_gap - loc[0] - 1,loc[1],0]);
			boost.push([8 + w_gap - loc[0] - 1,8 + h_gap - loc[1] - 1,0]);
			boost.push([loc[0],8 + h_gap - loc[1] - 1,0]);
		});
		for(let i=0;i<5;i++){
			for(let j=0;j<5;j++){
				boost.push([1 - h_gap/2 + s2*(i+j), 4 + h_gap/2 + s2*(j-i),-45]);
			}
		}
		for(let i=0;i<Math.floor(width - 8 - w_gap);i++){
			for(let j=0;j<Math.floor(8 + h_gap);j++){
				boost.push([8 + w_gap + i,j,0])
			}
		}
		if(width > 9){
			for(let i=0;i<9;i++){
				for(let j=0;j<Math.floor(height - 8 - h_gap);j++){
					boost.push([i,8 + h_gap + j,0])
				}
			}
			boost = boost.concat(getSquares(width - 9,height-8,true).coords.map(a => [a[0] + 9,a[1] + 8,a[2]]))
		}
		else{
			for(let i=0;i<Math.floor(width);i++){
				for(let j=0;j<Math.floor(height - 8 - h_gap);j++){
					boost.push([i,8 + h_gap + j,0])
				}
			}
		}
		if(boost.length > record.coords.length){
			record.coords = boost
		}
	}
	if(width > 8 && height > 8 && (width + height - Math.floor(width) - Math.floor(height) >= 8*s1 - 10)){//66
		let h_gap = height - Math.floor(height);
		let w_gap = width - Math.floor(width);
		let boost = [
			[0,8+h_gap - 2,0],[0,8+h_gap - 1,0],[1,8+h_gap - 1,0],
			[6+w_gap,0,0],[7+w_gap,0,0],[7+w_gap,1,0],
		];
		[[0,0],[1,0],[2,0],[3,0],[4,0],[0,1],[1,1],[2,1],[3,1],[0,2],[1,2],[2,2],[0,3],[1,3],[0,4]].forEach(loc => {
			boost.push([loc[0],loc[1],0]);
			boost.push([8+w_gap - loc[0] - 1,8+h_gap - loc[1] - 1,0]);
		});
		[[5,0],[4,1],[3,2],[2,3],[1,4],[0,5]].forEach(loc => {
			boost.push([8+w_gap - loc[0] - 1,8+h_gap - loc[1] - 1,0]);
		});
		for(let i=0;i<8;i++){
			for(let j=0;j<3;j++){
				boost.push([2+w_gap/2 + s2*i - j*s2,8+h_gap - 1 + w_gap/2 - i*s2 - j*s2,-135]);
			}
		}
		for(let i=0;i<Math.floor(width - 8 - w_gap);i++){
			for(let j=0;j<Math.floor(8 + h_gap);j++){
				boost.push([8 + w_gap + i,j,0])
			}
		}
		if(width > 9){
			for(let i=0;i<9;i++){
				for(let j=0;j<Math.floor(height - 8 - h_gap);j++){
					boost.push([i,8 + h_gap + j,0])
				}
			}
			boost = boost.concat(getSquares(width - 9,height-8,true).coords.map(a => [a[0] + 9,a[1] + 8,a[2]]))
		}
		else{
			for(let i=0;i<Math.floor(width);i++){
				for(let j=0;j<Math.floor(height - 8 - h_gap);j++){
					boost.push([i,8 + h_gap + j,0])
				}
			}
		}
		if(boost.length > record.coords.length){
			record.coords = boost
		}
	}
	if(width > 9 && height > 8 && (width + height - Math.floor(width) - Math.floor(height) >= 6*s1 - 7)){//76
		if(record.coords.length < Math.floor(width)*Math.floor(height) + 4){
			let h_gap = height - Math.floor(height);
			let w_gap = width - Math.floor(width) + 1;
			record.coords = [];
			[[0,0],[1,0],[2,0],[3,0],[0,1],[1,1],[2,1],[0,2],[1,2],[0,3]].forEach(loc => {
				record.coords.push([loc[0],loc[1],0]);
				record.coords.push([8 + w_gap - loc[0] - 1,loc[1],0]);
				record.coords.push([8 + w_gap - loc[0] - 1,8 + h_gap - loc[1] - 1,0]);
				record.coords.push([loc[0],8 + h_gap - loc[1] - 1,0]);
			});
			for(let i=0;i<6;i++){
				for(let j=0;j<6;j++){
					record.coords.push([1 - h_gap/2 + s2*(i+j), 4 + h_gap/2 + s2*(j-i),-45]);
				}
			}
			for(let i=0;i<Math.floor(width - 8 - w_gap);i++){
				for(let j=0;j<Math.floor(8 + h_gap);j++){
					record.coords.push([8 + w_gap + i,j,0])
				}
			}
			for(let i=0;i<Math.floor(width);i++){
				for(let j=0;j<Math.floor(height - 8 - h_gap);j++){
					record.coords.push([i,8 + h_gap + j,0])
				}
			}
		}
	}
	if(width > 9 && height > 9 && (width + height - Math.floor(width) - Math.floor(height) >= 14*s2 - 8)){//89
		if(record.coords.length < Math.floor(width)*Math.floor(height) + 8){
			let h_gap = height - Math.floor(height);
			let w_gap = width - Math.floor(width);
			record.coords = [];
			[[0,0],[1,0],[2,0],[3,0],[0,1],[1,1],[2,1],[0,2],[1,2],[0,3]].forEach(loc => {
				record.coords.push([loc[0],loc[1],0]);
				record.coords.push([9 + w_gap - loc[0] - 1,loc[1],0]);
				record.coords.push([9 + w_gap - loc[0] - 1,9 + h_gap - loc[1] - 1,0]);
				record.coords.push([loc[0],9 + h_gap - loc[1] - 1,0]);
			});
			for(let i=0;i<7;i++){
				for(let j=0;j<7;j++){
					record.coords.push([0.5 - h_gap/2 + s2*(i+j), 4.5 + h_gap/2 + s2*(j-i),-45]);
				}
			}
			for(let i=0;i<Math.floor(width - 9 - w_gap);i++){
				for(let j=0;j<Math.floor(9 + h_gap);j++){
					record.coords.push([9 + w_gap + i,j,0])
				}
			}
			for(let i=0;i<Math.floor(width);i++){
				for(let j=0;j<Math.floor(height - 9 - h_gap);j++){
					record.coords.push([i,9 + h_gap + j,0])
				}
			}
		}
	}
	if(width > 33 && height > 33 && (width + height - Math.floor(width) - Math.floor(height) >= 24*s1 - 32)){//1120
		if(record.coords.length < Math.floor(width)*Math.floor(height) + 31){
			let h_gap = height - Math.floor(height);
			let w_gap = width - Math.floor(width);
			record.coords = [];
			for(let i=0;i<16;i++){
				for(let j=0;j+i<16;j++){
					record.coords.push([i,j,0]);
					record.coords.push([33 + w_gap - i - 1,j,0]);
					record.coords.push([33 + w_gap - i - 1,33 + h_gap - j - 1,0]);
					record.coords.push([i,33 + h_gap - j - 1,0]);
				}
			}
			for(let i=0;i<24;i++){
				for(let j=0;j<24;j++){
					record.coords.push([0.5 - h_gap/2 + s2*(i+j), 16.5 + h_gap/2 + s2*(j-i),-45]);
				}
			}
			for(let i=0;i<Math.floor(width - 33 - w_gap);i++){
				for(let j=0;j<Math.floor(33 + h_gap);j++){
					record.coords.push([33 + w_gap + i,j,0])
				}
			}
			for(let i=0;i<Math.floor(width);i++){
				for(let j=0;j<Math.floor(height - 33 - h_gap);j++){
					record.coords.push([i,33 + h_gap + j,0])
				}
			}
		}
	}
	if(width > 57 && height > 57 && (width + height - Math.floor(width) - Math.floor(height) >= 41*s1 - 56)){//3305
		if(record.coords.length < Math.floor(width)*Math.floor(height) + 56){
			let h_gap = height - Math.floor(height);
			let w_gap = width - Math.floor(width);
			record.coords = [];
			for(let i=0;i<28;i++){
				for(let j=0;j+i<28;j++){
					record.coords.push([i,j,0]);
					record.coords.push([57 + w_gap - i - 1,j,0]);
					record.coords.push([57 + w_gap - i - 1,57 + h_gap - j - 1,0]);
					record.coords.push([i,57 + h_gap - j - 1,0]);
				}
			}
			for(let i=0;i<41;i++){
				for(let j=0;j<41;j++){
					record.coords.push([0.5 - h_gap/2 + s2*(i+j), 28.5 + h_gap/2 + s2*(j-i),-45]);
				}
			}
			for(let i=0;i<Math.floor(width - 57 - w_gap);i++){
				for(let j=0;j<Math.floor(57 + h_gap);j++){
					record.coords.push([57 + w_gap + i,j,0])
				}
			}
			for(let i=0;i<Math.floor(width);i++){
				for(let j=0;j<Math.floor(height - 57 - h_gap);j++){
					record.coords.push([i,57 + h_gap + j,0])
				}
			}
		}
	}
	if(width > 12 && height > 12 && (width + height - Math.floor(width) - Math.floor(height) >= 8*s1 - 10)){//148
		let h_gap = height - Math.floor(height);
		let w_gap = width - Math.floor(width);
		let boost = [];
		for(let i=0;i<6;i++){
			for(let j=0;j+i<6;j++){
				boost.push([i,j,0]);
				boost.push([12 + w_gap - i - 1,j,0]);
				boost.push([12 + w_gap - i - 1,12 + h_gap - j - 1,0]);
				boost.push([i,12 + h_gap - j - 1,0]);
			}
		}
		for(let i=0;i<8;i++){
			for(let j=0;j<8;j++){
				boost.push([1 - h_gap/2 + s2*(i+j), 6 + h_gap/2 + s2*(j-i),-45]);
			}
		}
		for(let i=0;i<Math.floor(width - 12- w_gap);i++){
			for(let j=0;j<Math.floor(12 + h_gap);j++){
				boost.push([12 + w_gap + i,j,0])
			}
		}
		if(width > 13){
			for(let i=0;i<13;i++){
				for(let j=0;j<Math.floor(height - 12 - h_gap);j++){
					boost.push([i,12 + h_gap + j,0])
				}
			}
			boost = boost.concat(getSquares(width - 13,height-12,true).coords.map(a => [a[0] + 13,a[1] + 12,a[2]]))
		}
		else{
			for(let i=0;i<Math.floor(width);i++){
				for(let j=0;j<Math.floor(height - 12 - h_gap);j++){
					boost.push([i,12 + h_gap + j,0])
				}
			}
		}
		if(boost.length > record.coords.length){
			record.coords = boost
		}
	}
	[[6,4],[16,11],[20,14],[22,15],[26,18],[30,21],[32,22],[34,24],[36,25],[40,28],[42,29]].forEach(pair => {//some goebel squares	
		if(width > pair[0] && height > pair[0] && (width + height - Math.floor(width) - Math.floor(height) >= (pair[1] - s1*(pair[0]/2-1))/2 * s1*2)){//gbel
			let h_gap = height - Math.floor(height);
			let w_gap = width - Math.floor(width);
			let boost = [];
			for(let i=0;i<pair[0]/2;i++){
				for(let j=0;j+i<pair[0]/2;j++){
					boost.push([i,j,0]);
					boost.push([pair[0] + w_gap - i - 1,j,0]);
					boost.push([pair[0] + w_gap - i - 1,pair[0] + h_gap - j - 1,0]);
					boost.push([i,pair[0] + h_gap - j - 1,0]);
				}
			}
			for(let i=0;i<pair[1];i++){
				for(let j=0;j<pair[1];j++){
					boost.push([1 - h_gap/2 + s2*(i+j), pair[0]/2 + h_gap/2 + s2*(j-i),-45]);
				}
			}
			for(let i=0;i<Math.floor(width - pair[0]- w_gap);i++){
				for(let j=0;j<Math.floor(pair[0] + h_gap);j++){
					boost.push([pair[0] + w_gap + i,j,0])
				}
			}
			if(width > pair[0]+1){
				for(let i=0;i<pair[0]+1;i++){
					for(let j=0;j<Math.floor(height - pair[0] - h_gap);j++){
						boost.push([i,pair[0] + h_gap + j,0])
					}
				}
				boost = boost.concat(getSquares(width - pair[0]-1,height-pair[0],true).coords.map(a => [a[0] + pair[0]+1,a[1] + pair[0],a[2]]))
			}
			else{
				for(let i=0;i<Math.floor(width);i++){
					for(let j=0;j<Math.floor(height - pair[0] - h_gap);j++){
						boost.push([i,pair[0] + h_gap + j,0])
					}
				}
			}
			if(boost.length > record.coords.length){
				record.coords = boost
			}
		}
	})
	if(width > Math.SQRT2*4 && height > Math.SQRT2*4 && (width + height > 6 + Math.SQRT2*4) && record.coords.length < 28){
		let m = height/2 - 2
		record.coords = [
			[0,0,0],
			[1,0,0],
			[0,1,0],

			[width - 1,0,0],
			[width - 2,0,0],
			[width - 1,1,0],

			[width - 1,height - 1,0],
			[width - 2,height - 1,0],
			[width - 1,height - 2,0],

			[0,height - 1,0],
			[1,height - 1,0],
			[0,height - 2,0],

			[1-m,2+m,-45],[1-m+s2,2+m-s2,-45],[1-m+s2*2,2+m-s2*2,-45],[1-m+s2*3,2+m-s2*3,-45],
			[1-m+s2,2+m+s2,-45],[1-m+s2+s2,2+m-s2+s2,-45],[1-m+s2+s2*2,2+m-s2*2+s2,-45],[1-m+s2+s2*3,2+m-s2*3+s2,-45],
			[1-m+s1,2+m+s1,-45],[1-m+s2+s1,2+m-s2+s1,-45],[1-m+s2*2+s1,2+m-s2*2+s1,-45],[1-m+s2*3+s1,2+m-s2*3+s1,-45],
			[1-m+s2*3,2+m+s2*3,-45],[1-m+s2+s2*3,2+m-s2+s2*3,-45],[1-m+s2*2+s2*3,2+m-s2*2+s2*3,-45],[1-m+s2*3+s2*3,2+m-s2*3+s2*3,-45],
		]
	}
	if(width > 2 && height > 2){
		let h_gap = height - Math.floor(height);
		let w_gap = s1 - h_gap;
		if(!(w_gap >= 1)){
			let units = Math.floor((width - 1)/(w_gap + 1));
			let num = units*3 + 2 + (Math.floor(height) - 2)*Math.floor(width);
			if(width - units*(w_gap + 1) - 1 > 1){
				num += 2
			}
			if(record.coords.length < num){
				record.coords = [[0,0,0],[0,1+h_gap,0]];
				for(let i=0;i<units;i++){
					record.coords.push([(i+1)*(w_gap + 1),0,0]);
					record.coords.push([(i+1)*(w_gap + 1),1+h_gap,0]);
					record.coords.push([(i+1)*(w_gap + 1) - w_gap - h_gap/2,1+h_gap/2,-45]);
				}
				if(width - units*(w_gap + 1) - 1 > 1){
					record.coords.push([units*(w_gap + 1)+1,0,0]);
					record.coords.push([units*(w_gap + 1)+1,1+h_gap,0]);
				}
				for(let i=0;i<Math.floor(width);i++){
					for(let j=0;j<Math.floor(height - 2);j++){
						record.coords.push([i,2+h_gap + j,0])
					}
				}
			}
		}
	}
	if(width > 2 && height > 2){
		let h_gap = height - Math.floor(height);
		if((h_gap >= s1*2 - 2)){
			let end_cap = 2 + s1 - h_gap
			let units = Math.floor((width - end_cap)/(s1));
			let num = units*3 + 5 + (Math.floor(height) - 2)*Math.floor(width);
			if(record.coords.length < num){
				record.coords = [[0,0,0],[0,1+h_gap,0],[width - 1,0,0],[width - 1,1+h_gap,0],[1-h_gap/2,1+h_gap/2,-45]];
				for(let i=0;i<units;i++){
					record.coords.push([i*s1 + 1-h_gap/2 + s2,1+h_gap/2-s2,-45]);
					record.coords.push([i*s1 + 1-h_gap/2 + s2,1+h_gap/2+s2,-45]);
					record.coords.push([i*s1 + 1-h_gap/2 + s1,1+h_gap/2,-45]);
				}
				for(let i=0;i<Math.floor(width);i++){
					for(let j=0;j<Math.floor(height - 2);j++){
						record.coords.push([i,2+h_gap + j,0])
					}
				}
			}
		}
	}

	if(width > 1 && height > 1){
		let way1 = gen_slant(width,height);
		if(way1.length > record.coords.length){
			record.coords = way1;
			record.comment = "slant"
		}
		let way2 = gen_slant(height,width);
		if(way2.length > record.coords.length){
			record.coords = transpose(way2);
			record.comment = "slant"
		}
	}
	//gbel strip:
	if(width > 2 && height > 2){
		let base_board = Math.floor(height) - 1;
		let h_gap = height - base_board - 1;
		let secondary = Math.floor(width);
		let w_gap = width - secondary;
		if(width - secondary + height - base_board - 1 >= s1){
			let len = Math.floor(s1 * (base_board - 1) + s1 * h_gap/2 + s1 * w_gap/2);
			//console.log("gob",len + base_board*base_board + base_board + 2 + (secondary - base_board - 1) * (base_board+1));
			if(len + base_board*base_board + base_board + 2 + (secondary - base_board - 1) * (base_board+1) > record.coords.length){
				record.coords = [[base_board + w_gap,0,0],[0,base_board + h_gap,0]];
				for(let i=0;i<base_board;i++){
					for(let j=0;i+j<base_board;j++){
						record.coords.push([i,j,0]);
						record.coords.push([base_board + w_gap - i,base_board + h_gap - j,0]);
					}
				}
				for(let i=0;i<len;i++){
					record.coords.push([1-h_gap/2 + i*s2,base_board + h_gap/2 - i*s2,-45]);
				}
				for(let i=0;i<(secondary - base_board - 1);i++){
					for(let j=0;j<(base_board+1);j++){
						record.coords.push([base_board + w_gap + 1+i,j,0])
					}
				}
			}
		}
	}
	//slanted gbel strip
	if(width > 2 && height > 2){
		let h_gap = height - Math.floor(height);
		let w_gap = width - Math.floor(width);
		if(h_gap*h_gap + w_gap*w_gap >= 1){
			let alf = (w_gap * h_gap * h_gap)/(w_gap*w_gap + h_gap*h_gap);
			let ang = Math.atan(h_gap/w_gap);
			let diag = Math.hypot(Math.floor(height) + w_gap - 2,height - 2);
			let ang2 = Math.acos((height - 2)/diag);
			let diff_ang = ang2 - ang;
			let diffComp = Math.cos(diff_ang);
			let real_diag = diag*diffComp;
			let count = Math.floor(width)*Math.floor(height) - Math.floor(height) + 2 + Math.floor(real_diag);
			//console.log("real",real_diag,diag);
			//console.log("ang",ang*180/Math.PI,ang2*180/Math.PI);
			if(count > record.coords.length){
				record.coords = [[0,0,0],[Math.floor(height) + w_gap - 1,height - 1,0]];
				let stair = Math.floor(height) - 1;
				for(let i=0;i<stair;i++){
					for(let j=0;j+i<stair;j++){
						record.coords.push([j,height - 1 - i,0])
						record.coords.push([Math.floor(height) + w_gap - 1 - j,i,0])
					}
				}
				let x1 = 1 - alf;
				let y1 = 1 + alf*h_gap/w_gap;
				let c = Math.cos(ang);
				let s = Math.sin(ang);
				record.coords.push([x1,y1,-ang*180/Math.PI]);
				if(w_gap > h_gap){
					let cx = x1 + s;
					let cy = y1 + c;
					for(let i = 1;i<Math.floor(real_diag);i++){
						let diff = 1 - ((cy - 1 - h_gap) % 1);
						if(diff < c){
							let future = cx + diff*s/c;
							let hylle = Math.floor(cy - 1 - h_gap) + 2;
							let bon1 = (hylle - future);
							let diff2 = (c - diff)*(s/c + c/s);
							if(diff2 < bon1){
								record.coords.push([cx+diff2*c*c,cy-diff2*c*s,-ang*180/Math.PI]);
								cx += bon1*c*c;
								cy -= bon1*c*s;
							}
							else{
								cx += bon1*c*c;
								cy -= bon1*c*s;
								record.coords.push([cx,cy,-ang*180/Math.PI]);
							}
						}
						else{
							record.coords.push([cx,cy,-ang*180/Math.PI]);
						}
						cx += s;
						cy += c;
					}
				}
				else{
					let cx = x1 + s + c;
					let cy = y1 - s + c;
					//console.log("a",x1,y1);
					for(let i = 1;i<Math.floor(real_diag);i++){
						let diff = 1 - ((cx - 1 - w_gap) % 1);
						//console.log("diff c 2", diff,c,s);
						if(diff < s){
							let future = cy + diff*c/s;
							let hylle = Math.floor(cx - 1 - w_gap) + 2;
							let bon1 = (hylle - future);
							let diff2 = (s - diff)*(s/c + c/s);
							if(diff2 < bon1){
								record.coords.push([cx-diff2*c*s,cy+diff2*s*s,90-ang*180/Math.PI]);
								cy += bon1*s*s;
								cx -= bon1*c*s;
							}
							else{
								cy += (hylle - future)*s*s;
								cx -= (hylle - future)*c*s;
								record.coords.push([cx,cy,90-ang*180/Math.PI]);
							}
						}
						else{
							record.coords.push([cx,cy,90-ang*180/Math.PI]);
						}
						cx += s;
						cy += c;
					}
				}
				for(let i=0;i<Math.floor(width - Math.floor(height) - w_gap);i++){
					for(let j=0;j<Math.floor(height);j++){
						record.coords.push([i + w_gap + Math.floor(height),j,0]);
					}
				}
				if(record.coords.length < count){
					throw "uhoh..."
				}
			}
		}
	}
	//gbel strip x2:
	if(width > 3 && height > 3 && (width + height - Math.floor(width) - Math.floor(height)) >= 2*s1 - 1){
		let h_gap = height - Math.floor(width);
		let w_gap = width - Math.floor(width);
		let st = Math.floor(height) - 2;
		let st2 = Math.floor(height) - 1;
		let count = (st*st + st)/2;
		count += (st2*st2 + st2)/2 + 2;
		count += Math.floor(width - Math.floor(height) - w_gap) * Math.floor(height);
		count += 2 * Math.floor(s1 * (height - 2));
		if(count > record.coords.length){
			//console.log(count,record.coords.length);
			record.coords = [
				[0,height - 1,0],
				[w_gap + Math.floor(height)-1,0,0]
			];
			for(let i=0;i<st;i++){
				for(let j=0;j+i<st;j++){
					record.coords.push([i,j,0])
				}
			}
			for(let i=0;i<st2;i++){
				for(let j=0;j+i<st2;j++){
					record.coords.push([st2 + w_gap - i,height - j - 1,0])
				}
			}
			for(let i=0;i<Math.floor(width - Math.floor(height) - w_gap);i++){
				for(let j=0;j<Math.floor(height);j++){
					record.coords.push([st2 + 1 + w_gap + i,j,0])
				}
			}
			for(let i = 0;i<Math.floor(s1 * (height - 2));i++){
				record.coords.push([1/2 - w_gap/2 + s2*i,height - 1 - (1 + w_gap)/2 - i*s2,-45]);
				record.coords.push([1/2 - w_gap/2 + s2*i + s2,height - 1 - (1 + w_gap)/2 + s2 - i*s2,-45]);
			}
			if(record.coords.length !== count){
				throw "up"
			}
		}
	}
	squareList.forEach(arr => {
		if(width >= arr.x && height >= arr.y){
			if(record.coords.length < arr.n + Math.floor(width - arr.x)*Math.floor(arr.y) + Math.floor(height - arr.y)*Math.floor(width)){
				record.coords = arr.coords.map(a => a);
				for(let i=0;i<Math.floor(width - arr.x);i++){
					for(let j=0;j<Math.floor(arr.y);j++){
						record.coords.push([arr.x+i,j,0])
					}
				}
				for(let i=0;i<Math.floor(width);i++){
					for(let j=0;j<Math.floor(height - arr.y);j++){
						record.coords.push([i,arr.y + j,0])
					}
				}
			}
			let numa = Math.floor(width/arr.x);
			if(record.coords.length < arr.n*numa + Math.floor(width - arr.x*numa)*Math.floor(arr.y) + Math.floor(height - arr.y)*Math.floor(width)){
				//alert("when?" + width + "," + height);
				record.coords = arr.coords.map(a => a);
				for(let i=1;i<numa;i++){
					record.coords = record.coords.concat(arr.coords.map(a => [a[0]+i*arr.x,a[1],a[2]]))
				}
				for(let i=0;i<Math.floor(width - arr.x*numa);i++){
					for(let j=0;j<Math.floor(arr.y);j++){
						record.coords.push([arr.x*numa+i,j,0])
					}
				}
				for(let i=0;i<Math.floor(width);i++){
					for(let j=0;j<Math.floor(height - arr.y);j++){
						record.coords.push([i,arr.y + j,0])
					}
				}
			}
		}
	})
	if(width > 8 && height > 8 && !recursive){
		let biggie = graham(width,height);
		if(biggie.length > record.coords.length){
			record.coords = biggie
		}
	}
	return record
}
const svgNS = "http://www.w3.org/2000/svg";
let illustration = document.createElementNS(svgNS,"svg");
svgContainer.appendChild(illustration);
let dimensions = {
	width: 600,
	height: 600,
	margin: 10,
	scale: 100,
};
function plotSquares(info,width,height){
	//console.log(info);
	removeChildren(illustration);
	/*let scale = Math.min(
		(dimensions.width - dimensions.margin*2)/width,
		(dimensions.height - dimensions.margin*2)/height
	)
	illustration.style.width = dimensions.width + "px";
	illustration.style.height = dimensions.height + "px";
	illustration.setAttributeNS(null,"viewBox",-dimensions.margin + " " + (-dimensions.margin) + " " + dimensions.width + " " + dimensions.height);
	svgContainer.style.width = dimensions.width + "px";
	svgContainer.style.height = dimensions.height + "px";*/
	let scale = dimensions.scale;
	illustration.style.width = (width*dimensions.scale + dimensions.margin*2) + "px";
	illustration.style.height = (height*dimensions.scale + dimensions.margin*2) + "px";
	illustration.setAttributeNS(null,"viewBox",-dimensions.margin + " " + (-dimensions.margin) + " " + (width*dimensions.scale + dimensions.margin*2) + " " + (height*dimensions.scale + dimensions.margin*2));
	svgContainer.style.width = width*dimensions.scale + dimensions.margin*2 + "px";
	svgContainer.style.height = height*dimensions.scale + dimensions.margin*2 + "px";
	let cont = document.createElementNS(svgNS,"rect");
	cont.setAttributeNS(null,"stroke","blue");
	cont.setAttributeNS(null,"fill","none");
	cont.setAttributeNS(null,"x",0);
	cont.setAttributeNS(null,"y",0);
	cont.setAttributeNS(null,"width",width*scale);
	cont.setAttributeNS(null,"height",height*scale);
	illustration.appendChild(cont);
	if(height > width){
		info.coords = transpose(info.coords)
	}
	info.coords.forEach(s => {
		let square = document.createElementNS(svgNS,"rect");
		square.setAttributeNS(null,"stroke","black");
		square.setAttributeNS(null,"stroke-width","1");
		square.setAttributeNS(null,"fill","green");
		square.setAttributeNS(null,"x",s[0]*scale);
		square.setAttributeNS(null,"y",s[1]*scale);
		square.setAttributeNS(null,"width",scale);
		square.setAttributeNS(null,"height",scale);
		if(!s[2]){
			s[2] = 0
		}
		if(s[2] !== 0){
			if(s[2] === -45 || s[2] === -135 || s[2] === 45 || s[2] === 135 || s[2] === 225){
				square.setAttributeNS(null,"fill","blue");
				square.setAttributeNS(null,"transform","rotate(" + s[2] + "," + s[0]*scale + "," + s[1]*scale +  ")");
			}
			else{
				square.setAttributeNS(null,"fill","red");
				//square.setAttributeNS(null,"fill","black");
				square.setAttributeNS(null,"transform","rotate(" + (s[2]) +"," + s[0]*scale + "," + s[1]*scale +  ")");
			}
		}
		illustration.appendChild(square)
	})
	efficiency.innerText = "n = " + info.coords.length + ", density: " + (100 * info.coords.length/(width*height)).toPrecision(4) + "%";
	comment.innerText = info.comment;
}
let handled = false;
let rfunk = function(){
	if(handled){
		handled = false;
		return
	}
	let rect = svgContainer.getClientRects();
	let newWidth = ((rect[0].width - dimensions.margin*2)/dimensions.scale);
	let newHeight = ((rect[0].height - dimensions.margin*2)/dimensions.scale);
	//console.log(newWidth,widthInput.value);
	if(newWidth != widthInput.value || newHeight != heightInput.value){
		widthInput.value = newWidth;
		heightInput.value = newHeight;
		updateDimensions();
	}
}
let obe = new ResizeObserver(rfunk);
obe.observe(svgContainer);	
function updateDimensions(){
	width = parseFloat(widthInput.value) || 1;
	if(squareInput.checked){
		height = parseFloat(widthInput.value) || 1;
		heightInput.style.opacity = "0.5";
	}
	else{
		heightInput.style.opacity = "1";
		height = parseFloat(heightInput.value) || 1;
	}
	if(height > 200){
		return
	}
	if(width > 200){
		return
	}
	handled = true;
	plotSquares(getSquares(Math.max(width,height),Math.min(width,height)),width,height);
}
function apply(){
	updateDimensions();
}
svgContainer.style.width = (widthInput.value || 1)*dimensions.scale + dimensions.margin*2 + "px";
svgContainer.style.height = (heightInput.value || 1)*dimensions.scale + dimensions.margin*2 + "px";
illustration.setAttributeNS(null,"viewBox",-dimensions.margin + " " + (-dimensions.margin) + " " + ((widthInput.value || 1)*dimensions.scale + dimensions.margin*2) + " " + ((heightInput.value || 1)*dimensions.scale + dimensions.margin*2));
squareInput.oninput = updateDimensions;
updateDimensions();

function rand(){
	widthInput.value = 1.5 + Math.random()*10;
	heightInput.value = 1.5 + Math.random()*10;
	updateDimensions()
}

function triangleFill(a,b){
	let delta1 = a/b;
	let square1 = 0;
	let base1 = a;
	while(base1 >= 1){
		base1 -= delta1;
		square1 += Math.max(Math.floor(base1),0)
	}
	let delta2 = a/b + b/a;
	let square2 = 0;
	let base2 = Math.hypot(a,b);
	while(base2 >= 1){
		base2 -= delta2;
		square2 += Math.max(Math.floor(base2),0)
	}
	return [square1,square2]
}

function triangleFill2(a,b){
	let delta1 = a/b;
	let square1 = 0;
	let base1 = a;
	let side1 = b;
	while(base1 >= 1){
		base1 -= delta1;
		side1 -= 1;
		square1 += Math.max(Math.floor(base1),0);
		let off = triangleFill(base1,side1);
		if(off[1] > off[0]){
			return off[1] + square1;
		}
	}
	let delta2 = a/b + b/a;
	let square2 = 0;
	let base2 = Math.hypot(a,b);
	while(base2 >= 1){
		base2 -= delta2;
		square2 += Math.max(Math.floor(base2),0)
	}
	return 0
}

function triangle_recursive(a,b){
	if(a < 1 || b < 1){
		return 0
	}
	let delta1 = a/b;
	let base1 = a - delta1;
	let res1 = Math.max(Math.floor(base1),0) + triangle_recursive(base1,b-1);
	let delta1b = b/a;
	let base1b = b - delta1b;
	let res1b = Math.max(Math.floor(base1b),0) + triangle_recursive(base1b,a-1);
	let delta2 = a/b + b/a;
	let hypot = Math.hypot(a,b);
	let base2 = hypot - delta2;
	let res2 = Math.max(Math.floor(base2),0) + triangle_recursive(a - hypot/b,b - hypot/a);
	return Math.max(res1,res2,res1b);
}


function triangleFill3(a,b){
	return triangleFill(a,b).concat([triangle_recursive(a,b)])
}

function teff(){
	let canvas = document.getElementById("triangle");
	canvas.width = 1500;
	canvas.height = 1500;
	let ctx = canvas.getContext("2d");
	ctx.fillStyle = "white";
	ctx.fillRect(0,0,canvas.width,canvas.height);
	for(let i=0;i<canvas.width;i++){
		for(let j=i;j<canvas.height ;j++){
			let res = getSquares(i*0.01,j*0.01).coords.length;
			let sob = Math.floor(i*0.01)*Math.floor(j*0.01);
			if(res > sob){
				if(res - sob === 1){
					ctx.fillStyle = "red";
				}
				else if(res - sob === 2){
					ctx.fillStyle = "green";
				}
				else if(res - sob === 3){
					ctx.fillStyle = "blue";
				}
				else if(res - sob === 4){
					ctx.fillStyle = "violet";
				}
				else if(res - sob === 5){
					ctx.fillStyle = "magenta";
				}
				else if(res - sob === 6){
					ctx.fillStyle = "grey";
				}
				else{
					ctx.fillStyle = "black";
				}
				ctx.fillRect(i,j,1,1);
				ctx.fillRect(j,i,1,1);
			}
/*
			let res = triangleFill3(i*0.01,j*0.01);
			
			if(res[2] > res[1] && res[2] > res[0]){
				ctx.fillStyle = "blue";
				ctx.fillRect(i,j,1,1);
				ctx.fillRect(j,i,1,1);
			}
			else if(res[0] > res[1]){
				ctx.fillStyle = "green";
				ctx.fillRect(i,j,1,1);
				ctx.fillRect(j,i,1,1);
			}
			else if(res[1] > res[0]){
				ctx.fillStyle = "red";
				ctx.fillRect(i,j,1,1);
				ctx.fillRect(j,i,1,1);
			}
*/
		}
	}
}

function tell(n){
	return Math.sqrt(2*n);
}
</script>
</body>
</html>
